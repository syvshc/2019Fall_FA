% !TeX root = main.tex

\chapter{线性算子与线性泛函}

\section{连续线性映射}

	\begin{Definition}\index{X!线性算子}
		设$ E, F $是$ \K $上的线性空间, 若映射$ u : E\to F $满足
		\[
			\forall \lambda\in\K\,\forall x,y\in E\,(u(\lambda x+y)=\lambda u(x)+u(y)),
		\]
		则称$ u : E\to F $是一个\textbf{线性映射}或\textbf{线性算子}, 并记$ \CL(E,F) $是$ E $到$ F $线性算子的全体.
	\end{Definition}
	
	特别地, 当$ E=F $时, 用$ \CL(E) $记$ \mathcal{L}(E,E) $.
	
	\begin{Example}~
	\begin{enumerate}[(1)]
		\item $ \forall \lambda\in\K $, 定义
		\[
			M_\lambda : E\to E,\qquad x\mapsto\lambda x,
		\]
		则$ M_\lambda\in\CL(E) $. 而对$ y\in E $, 定义
		\[
			T_y : E\to E,\qquad x\mapsto x+y,
		\]
		则$ T_y\notin\CL(E) $.
		
		\item 设$ E=C[0,1] $, 对$ f\in C[0,1] $, 定义$ M_fg=fg $, 则$ M_f $是线性算子. 再取$ x\in[0,1] $, 定义$ \delta_x(f)=f(x) $, 则$ \delta_x $是线性算子, 再定义
		\[
			I(f)(x)=\int_0^xf(t)\diff t,
		\]
	则$ I $也是线性算子.
	\end{enumerate}
	\end{Example}
	
	\begin{Remark}
		关于$ \CL(E,F) $的一些注记:
	\begin{enumerate}[(1)]
	\item $ \CL(E,F) $本身也是一个线性空间, 其上的线性运算可以定义为
	\[
		\begin{aligned}
			\lambda u : E\to F,& \quad x\mapsto\lambda u(x),\\
			u+v : E\to F,& \quad x\mapsto u(x)+v(x),
		\end{aligned}
	\]
	其中$ \lambda\in\K $, $ u, v\in\CL(E,F) $.
	
	\item 对$ u\in\CL(E,F) $, 定义其\textbf{核空间}\index{H!核空间}为
	\[
	\ker u=\{ x\in E : u(x)=0 \}.
	\]
	则$ \ker u $是$ E $的线性子空间, 且$ u $是单射当且仅当$ \ker u=\{0\} $.
	\end{enumerate}
	\end{Remark}
	
	\begin{Theorem}[连续性]\label{thm:线性算子连续性}
	设$ E, F $是$ \K $上的两个赋范空间, 且$ u\in\CL(E,F) $, 则下列命题等价:
	\begin{enumerate}[(1)]
	\item $ u $在$ E $上连续;
	\item $ u $在$ E $上的某一点连续;
	\item $ u $在原点连续;
	\item $ \exists C\geqslant 0\,\forall x\in E\,(\norm{u(x)}\leqslant C\norm{x}) $.
	\end{enumerate}
	\end{Theorem}
	\begin{Proof}
		(1) $ \Rightarrow $ (2) : 显然.
		
		(2) $ \Rightarrow $ (3) : 设$ u $在$ x_0\in E $连续, 那么
		\[
			\forall\varepsilon>0\,\exists r>0\,(x\in B(x_0,r)\Rightarrow\norm{u(x)-u(x_0)}<\varepsilon),
		\]
		则对$ \forall y\in B(0,r) $, 有
		\[
			\norm{u(y)-u(0)}=\norm{u(y)}=\norm{u(x_0+y)-u(x_0)}<\varepsilon,
		\]
		即$ u $在原点连续.
		
		(3) $ \Rightarrow $ (4) : 由$ u $在原点连续可知
		\[
			\exists r_0>0\,(y\in\overline{B(0,r)}\Rightarrow\norm{u(y)}<1).
		\]
		则$ \forall x\in E $, 由
		\[
			\norm{u(x)}=\norm{u\left(\dfrac{xr}{\norm{x}}\right)}\frac{\norm{x}}{r}<\frac{\norm{x}}{r},
		\]
		取$ C=\frac{1}{r} $即可.
		
		(4) $ \Rightarrow $ (1) : 由$ u\in\mathcal{L}(E,F) $, 有
		\[
			\forall x,y\in E\,(\norm{u(x)-u(y)}\leqslant C\norm{x-y}),
		\]
		即$ u $是Lipschitz的, 从而$ u $在$ E $连续.\qed
	\end{Proof}
	
	\begin{Remark}
		上述定理表明在赋范空间上, 连续线性映射都是Lipschitz的, 从而连续线性映射一定一致连续.
	\end{Remark}
	
	\begin{Definition}[算子范数]\index{Y!有界线性算子}
		设$ E,F $都是赋范空间, $ u\in\mathcal{L}(E,F) $. 若
		\[
			\forall C\geqslant 0\,\forall x\in E\,(\norm{u(x)}\leqslant C\norm{x}),
		\]
		则称$ u $是\textbf{有界}的. 再令
		\[
			\norm{u}=\sup_{\norm{x}\ne 0}\frac{\norm{u(x)}}{\norm{x}}
		\]
		称$ \norm{u} $是算子$ u $的\textbf{范数}. 并记$ \CB(E,F) $是$ E $到$ F $的有界线性算子的全体, 且类似地记$ \mathcal{B}(E)=\mathcal{B}(E,E) $.
	\end{Definition}
	
	\begin{Example}
		设$ E=\C^n $, 则$ \mathcal{L}(E)=\mathbb{M}_n(\C)=\mathcal{B}(E) $, 其中$ \mathbb{M}_n(\C) $是$ n $阶复矩阵的全体. 对$ A\in\mathbb{M}_n(\C) $, 定义
		\[
			\norm{A}=\sup_{\norm{x}\ne 0}\frac{\norm{Ax}}{\norm{x}}
		\]
		为$ A $的范数. 则由
		\[
			\norm{A}^2=\sup_{\norm{x}\ne 0}\frac{\norm{Ax}^2}{\norm{x}^2}=\sup_{\norm{x}\ne 0}\frac{\lrangle{Ax,Ax}}{\norm{x}^2}=\sup_{\norm{x}\ne 0}\frac{\lrangle{A^\dagger Ax,x}}{\norm{x}^2}=\sup\{\abs{\lambda}\},
		\]
		可知$ A $是有界线性算子. 其中$ \lambda $是$ A^\dagger A $的特征值.
	\end{Example}
	
	\begin{Remark}~
	\begin{enumerate}[(1)]
		\item $ \CB(E,F) $是$ \CL(E,F) $的线性子空间, 这由
		\[
			\norm{\lambda u}=\abs{\lambda}\norm{u},\qquad \norm{u+v}\leqslant\norm{u}+\norm{v}
		\]
		可知. 且$ (\mathcal{B}(E,F),\norm{\cdot}) $还是一个赋范空间. 由定理\ref{thm:线性算子连续性}可知$ u $连续等价于$ u $有界.
		
		\item $ u $的有界性实际上指$ \norm{u(x)} $在$ E $的有界集上有界. 实际上除非$ u\equiv 0 $, 否则$ \norm{u(x)} $不可能在全空间上有界.
		
		\item 范数$ \norm{u} $也可以等价地定义为
		\[
			\norm{u}:=\sup_{\norm{x}\ne 0}\frac{\norm{u(x)}}{\norm{x}}=\sup_{\norm{x}\leqslant 1}\norm{u(x)}=\sup_{\norm{x}=1}\norm{u(x)},
		\]
		且$ \norm{u} $就是定义中满足条件的$ C $中最小的.
	\end{enumerate}
	\end{Remark}

	\begin{Theorem}
		 设 $ E $ 是赋范空间,  $ F $ 是Banach空间, 则 $ \CB(E, F) $ 是Banach空间.
	\end{Theorem}
	\begin{Proof}
		取 $ (u_{n})_{n\geqslant1} $ 是 $ \CB(E, F) $ 上的 Cauchy列, 即 
		\[
			\forall\varepsilon>0\,\exists n_{0}\in\N\,(n, m\geqslant n_{0}\Rightarrow \norm{u_{m}-u_{n}}<\varepsilon)
		\]
		而 $ \forall x\in E $, 由
		\[
			\norm{u_{m}(x)-u_{n}(x)}=\norm{(u_{m}-u_{n})(x)}\leqslant\norm{u_{m}-u_{n}}\cdot\norm{x}
		\]
		可知 $ (u_{n}(x))_{n\geqslant1} $ 是 $ F $ 中的 Cauchy列, 因 $ F $ 是Banach空间, $ \lim\limits_{n\to \infty} u_{n}(x) $ 存在, 记作 $ u(x) $, 从而定义了算子 $ u $, 下证 $ u\in\CB(E, F) $. 由 
		\[
			\begin{aligned}
				u(\lambda x) & =\lim_{n\to\infty}u_{n}(\lambda x)\\
				& =\lambda\lim_{n\to\infty}u_{n}(x)=\lambda u(x)
			\end{aligned}\qquad
			\text{与}\qquad
			\begin{aligned}
				u(x+y) & =\lim_{n\to\infty}u_{n}(x+y)\\
				& =\lim_{n\to\infty}u_{n}(x)+u_{n}(y)=u(x)+u(y)
			\end{aligned}
		\]
		可知线性性成立, 再由
		\[
			\begin{aligned}
				\norm{u} & =\sup_{\norm{x}=1}\norm{u(x)}=\sup_{\norm{x}=1}\norm{u(x)-u_{n}(x)+u_{n}(x)}\\
				 & \leqslant \sup_{\norm{x}=1}\norm{u(x)-u_{n}(x)}+\sup_{\norm{x}=1}\norm{u_{n}(x)}\\
				& \leqslant \sup_{\norm{x}=1}\limsup_{m\to\infty}\norm{u_{m}-u_{n}}\cdot\norm{x}+\norm{u_{n}}<\infty
			\end{aligned}
		\]
		可知有界性成立. (因为 $ (u_{n})_{n\geqslant1} $ 是 Cauchy列, 从而 $ \limsup\limits_{m\to\infty}\norm{u_{m}-u_{n}}<\infty $)

		还需说明 $ \lim\limits_{n\to\infty}u_{n}=u $. 这由
		\[
			\begin{aligned}
				\norm{u-u_{n}} & =\sup_{\norm{x}=1}\norm{u(x)-u_{n}(x)}\leqslant \sup_{\norm{x}=1}\limsup_{m\to\infty
				}\norm{u_{m}-u_{n}}\norm{x}\\
				& =\limsup_{m\to\infty}\norm{u_{m}-u_{n}}\to 0\,(n\to\infty)
			\end{aligned}
		\]
		可知. 从而 $ \CB(E, F) $ 完备, 即为 Banach空间.\qed
	\end{Proof}

	\begin{Definition}[线性泛函]\label{def:线性泛函}
		 设 $ (E, \norm{\cdot}) $ 是数域 \K 上的赋范空间,  $ \CB(E, \K) $ 是 $ E $ 的\textbf{对偶}, 记作 $ E^{*} $, 则 $ E^{*} $ 是Banach空间, 并称 $ E^{*} $ 中的元素为 $ E $ 的\textbf{连续线性泛函}\index{L!连续线性泛函}.
	\end{Definition}
	\begin{Example}
		给出几个线性泛函相关的例子:
		\begin{enumerate}[(1)]
			\item  对 $ f\in C[0, 1] $, $ x\in [0, 1] $, 定义 $ \delta_{x}(f)=f(x) $, 则 $ \delta_{x} $ 是连续线性泛函; 再对 $ g\in C[0, 1] $ 定义 $ \rho_{g}(f)=\dint_{0}^{1}fg\diff x $, 则 $ \rho_{g} $ 是连续线性泛函.
			\item 在 $ \C^{n} $ 上给定 $ y\in\C^{n} $ 定义 
			 \[
				\rho_{y}(x)=\lrangle{x, y}=\sum_{i=1}^{n}x_{i}\baro{y}_{i}.
			\]
			由 Cauchy不等式可知 $ \rho_{y} $ 是连续线性泛函.
			\item $ \forall x, y\in \C^{n} $, 定义 $ \mathbb{M}_{n}(\C) $ 上的算子
			\[
				\omega_{x, y}(A)=\lrangle{Ax, y}.
			\]
			则由
			\[
				\abs{\omega_{x, y}(A)}=\abs{\lrangle{Ax, y}}\leqslant\norm{Ax}\norm{y}\leqslant\norm{A}\norm{x}\norm{y}
			\]
			知 $ \norm{\omega_{x, y}}\leqslant\norm{x}\norm{y}<\infty $, 从而 $ \omega_{x, y} $ 也是连续线性泛函.
			\item 对 $ x\in\C^{n} $ 和 $ A\in\mathbb{M}_{n}(\C) $, 定义 $ x\mapsto \norm{Ax} $, 则它不是连续线性泛函, 甚至不满足线性性.
		\end{enumerate}
	\end{Example}

	\begin{Theorem}
		 设 $ E $ 是有限维线性空间,  $ F $ 是任一赋范空间, 则 $ \mathcal{L}(E, F)=\CB(E, F) $.  
	\end{Theorem}
	\begin{Proof}
		设 $ u\in\CL(E, F) $, 取 $ E $ 的中的一组基 $ e_{1}, e_{2}, \dots e_{n} $, 则
		\[
			\forall x\in E\,\exists[x_{1}, x_{2}, \dots, x_{n}]^{\mathrm T}\,\left(x=\sum_{i=1}^{n}x_{i}e_{i}\right)
		\]
		因为 $ E $ 是有限维的, 故 $ E $ 中任意范数等价, 即 $ \norm{\cdot} $ 是 $ E $ 中的一个范数, 有
		\[
			\begin{aligned}
				\norm{u(x)}=\norm{\sum_{i=1}^{n}x_{i}u(e_{i})} & \leqslant \sum_{i=1}^{n}\abs{x_{i}}\norm{u(e_{i})}\\
				& \leqslant\norm{x}_{\infty}\sum_{i=1}^{n}\norm{u(e_{i})}\leqslant\left( c\sum_{i=1}^{n}\norm{u(e_{i})} \right)\norm{x}.
			\end{aligned}
		\]
		从而 $ u $ 有界, 即 $ \CL(E, F)\subset\CB(E, F) $, 从而 $ \CL(E, F)=\CB(E, F) $. \qed
	\end{Proof}
	
	\begin{Theorem}
		 设 $ E $, $ F $, $ G $都是赋范空间,  $ u\in\CB(E, F) $, $ v\in\CB(F, G) $, 则 $ v\circ u\in\CB(E, G) $, 且有 $ \norm{v\circ u}\leqslant\norm{v}\norm{u} $.
	\end{Theorem}
	\begin{Proof}
		因为
		\[
			\norm{v\circ u}=\sup_{\norm{x}=1}\norm{v(u(x))}\leqslant\norm{v}\sup_{\norm{x}=1}\norm{u(x)}\leqslant\norm{v}\norm{u}<\infty.
		\]
		定理结论可得.\qed
	\end{Proof}

	\begin{Remark}
		在不致混淆时, 有时也将 $ v\circ u $ 记作 $ vu $, 并将复合看作乘法, 因为 $ \CB(E) $ 上有自然的加法与数乘, 赋予乘法后 $ \CB(E) $ 成为一个代数.
	\end{Remark}

	\begin{Theorem}
		设 $ E $, $ F $ 是Banach空间,  $ G $ 是 $ F $ 的稠子空间, 则有界线性映射 $ u: G\to F $ 可以唯一地扩张成有界线性映射 $ \tilde{u}:E\to F $, 且 $ \norm{\tilde{u}}=\norm{u} $.
   \end{Theorem}
   \begin{Proof}
		因为 $ G $ 在 $ E $ 中稠密, 则
		\[
			\forall x\in E\,\exists(x_{n})_{n\geqslant1}\subset G\,(\lim_{n\to\infty}x_{n}=x),
		\]
		且 $ (u(x_{n}))_{n\geqslant1} $ 是 Cauchy列, 由 $ F $ 是Banach空间可知 $ (u(x_{n}))_{n\geqslant1} $ 收敛, 不妨记作 $ y $. 定义
		\[
			\tilde{u}: E\to F\quad x\mapsto y=\lim_{n\to\infty}u(x_{n}).
		\]
		由一致连续映射扩张定理可知 $ \tilde{u} $ well-defined.

		易证 $ \tilde{u} $ 是线性的, 且 $ \tilde{u}|_{G}=u $. 而
		\[
			\norm{\tilde{u}(x)}=\lim_{n\to\infty}\norm{u(x_{n})}\leqslant\norm{u}\lim_{n\to\infty}\norm{x_{n}}\leqslant\norm{u}\norm{x},
		\]
		故 $ \norm{\tilde{u}}\leqslant\norm{u} $, 再由 $ \tilde{u}|_{G}=u $ 知 $ \tilde{u}=\norm{u} $.\qed
		
	\end{Proof}

	\begin{Definition}[同构]\label{def:同构}
		 设 $ E $, $ F $ 是赋范空间, 若 $ u\in\CB(E, F) $ 是双射, 且 $ u^{-1} $ 连续, 则 $ u $ 是 $ E\to F $ 的\textbf{同构映射}. 若 $ E $, $ F $ 间存在同构映射, 则称 $ E $ 与 $ F $ \textbf{同构}.\index{T!同构}
	\end{Definition}

	\begin{Remark}
		设范数 $ \norm{\cdot}_{1} $ 与 $ \norm{\cdot}_{2} $ 等价, 则 $ \id_{E} $是同构映射. 在空间 $ \C^{n} $ 上, 相似变换 $ T $ 是同构映射, 且 $ \norm{T} $ 可以充分大. 一个例子是取
		\[
			T_{t}=\begin{bmatrix}
				1 & t\\
				0 & 1
			\end{bmatrix}
			\qquad
			T_{t}^{-1}=\begin{bmatrix}
				1 & -t \\
				0 & 1
			\end{bmatrix},
		\]
		则有 $ \norm{T_{t}}\geqslant1+\abs{t}/2 $, 且 $ \norm{T_{t}^{-1}}\geqslant 1+\abs{t}/2 $.  
	\end{Remark}

	\begin{Theorem}
		 设 $ E $ 是Banach空间,  $ u\in\CB(E) $ 且 $ \norm{u}<1 $ 则存在 $ v\in\CB(E) $ 使
		 \[
			 (\id_{E}-u)v=v(\id_{E}-u)=\id_{E},
		 \]
		 即 $ \id_{E}-u $ 是一个同构映射, 也即 $ \id_{E}-u $ 在 $ \CB(E) $ 可逆.
	\end{Theorem}
	\begin{Proof}
		由 $ \norm{u}<1 $ 可知 $ \sum\limits_{n\geqslant0}u^n $ 绝对收敛, 由 $ E $ 完备可知 $ \CB
		(E) $ 完备, 则 $ \exists v\in\CB(E) $ 使得 $ v=\sum\limits_{n\geqslant 0}u^n $, 则
		\[
			(\id_E-u)v=(\id_E-u)\sum_{n\geqslant 0}u^n=\lim_{n\to\infty}(\id_E-u^{n+1})=\id_E.
		\]
		同理可证 $ v(\id_E-u)=\id_E $, 则 $ v=(\id_E-u)^{-1} $.\qed
	\end{Proof}
	
	\begin{Theorem}
		设 $ E $是赋范空间, $ F\subset E $ 是闭线性子空间. 则
		\[
			\norm{x+F}_0:=\inf\{ \norm{x+y} : y\in F \},
		\]
		是商空间 $ E/F $ 上的一个范数. 在这一范数下 $ u : x\mapsto x+F $是连续的. 且 $ \norm{u}<1 $. 若 $ E $ 是Banach空间, 则 $ E/F $ 是Banach空间.
	\end{Theorem}
	\begin{Proof}
		先说明 $ \norm{\cdot}_{0} $ well-defined. 取 $ x' $ 是 $ x+F $ 的另一代表元, 往证 $ \norm{x'+F}_{0}=\norm{x+F}_{0} $. 因为
		\[
			\begin{aligned}
				\norm{x'+F}_{0} & =\inf\{ \norm{x'+y}:y\in F \}  = \inf\{ \norm{x+x'-x+y}: y\in F \} \\
				 & =\inf\{ \norm{x+y}: y\in F \}=\norm{x+F}_{0}
			\end{aligned}
		\]
		其中第三个等号是因为 $ x'-x+y\in F $. 则 $ \norm{\cdot}_{0} $ well-defined. 再证 $ \norm{\cdot}_{0} $ 是一个范数. 由
		\[
			\begin{aligned}
				\norm{x+F}_{0}=0 & \Longleftrightarrow d(x, F)=0\\
				&  \Longleftrightarrow x\in F\\
				& \Longleftrightarrow x+F=F
			\end{aligned}
		\]
		知正定性成立. 再由
		\[
			\begin{aligned}
				\norm{\lambda x+F}_{0} & =\inf\{ \norm{\lambda x+y}: y\in F \}=\abs{\lambda}\inf\left\{ \norm{x+\frac{y}{\lambda}}: y\in F \right\}\\
				& =\abs{\lambda}\inf\{ \norm{x+y}: y\in F \}=\abs{\lambda}\norm{x+F}_{0}
			\end{aligned}
		\]
		知齐次性成立, 这里 $ \lambda\neq0 $. 下面证明三角不等式 $ \forall\varepsilon>0 $, 对 $ x_{1}, x_{2} $, 有
		\[
			\exists y_{i}\in F : \norm{x_{i}+y_{i}}\leqslant\norm{x_{i}+F}_{0}+\varepsilon, \qquad i=1, 2
		\]
		则
		\[
			\begin{aligned}
				\norm{x_{1}+x_{2}+F}_{0} & =\inf\{ \norm{x_{1}+x_{2}+y}: y=F \}\\
				& =\inf\{ \norm{x_{1}+y_{1}+x_{2}+y_{2}}: y_{1}, y_{2}\in F \}\\
				& \leqslant \norm{x_{1}+F}_{0}+\norm{x_{2}+F}_{0}+2\varepsilon,
			\end{aligned}
		\]
		令 $ \varepsilon\to 0 $ 即得. 从而 $ \norm{\cdot} $ 是 $ E/F $ 上的范数. 且由
		\[
			 \norm{u(x)}=\norm{x+F}_{0}\leqslant \norm{x+0}=\norm{0}
		\]
		知 $ \norm{u}<1 $.

		若 $ E $ 是Banach空间. 取 $ E/F $ 中绝对收敛的级数 $ \sum\limits_{n\geqslant1}(x_{n}+F) $, 则
		\[
			\exists y_{n}\in F\,(\norm{x_{n}+y_{n}}\leqslant 2^{-n}+\norm{x_{n}+F}_{0})
		\]
		从而由 $ \sum\limits_{n\geqslant}\norm{x_{n}+F}_{0} $ 收敛知 $ \sum\limits_{n\geqslant0}\norm{x_{n}+y_{n}} $ 在 $ E $ 中绝对收敛, 则
		\[
			\exists z\in E\,\bigg( \sum_{n\geqslant0}(x_{n}+y_{n})=z \bigg)
		\]
		而 
		\[
			\begin{aligned}
				\norm{z+F-\sum_{k=1}^{n}x_{k}+F}_{0} & =\inf\left\{ \norm{z-\sum_{k=1}^{n}x_{k}+y}:y\in F \right\}\\
				& \leqslant \norm{z-\sum_{k=1}^{n}(x_{k}+y_{n})}\to 0,\qquad n\to\infty
			\end{aligned}
		\]
		即 $ E/F $ 是Banach空间.\qed
	\end{Proof}